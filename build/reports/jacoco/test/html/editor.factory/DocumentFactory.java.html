<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DocumentFactory.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">assignment1</a> &gt; <a href="index.source.html" class="el_package">editor.factory</a> &gt; <span class="el_source">DocumentFactory.java</span></div><h1>DocumentFactory.java</h1><pre class="source lang-java linenums">package editor.factory;

import editor.core.Document;
import editor.core.UnknownDocumentFormatException;

import java.util.*;

/**
 * Factory for creating documents using a registry-based approach.
 * Document providers are registered at startup, allowing new formats
 * to be added without modifying this class or the editor.
 */
public class DocumentFactory {
    
    private final Map&lt;String, DocumentProvider&gt; registry;
    
<span class="fc" id="L17">    public DocumentFactory() {</span>
<span class="fc" id="L18">        this.registry = new HashMap&lt;&gt;();</span>
<span class="fc" id="L19">    }</span>
    
    /**
     * Registers a document provider.
     * @param provider the provider to register
     * @return this factory for fluent chaining
     */
    public DocumentFactory register(DocumentProvider provider) {
<span class="fc bfc" id="L27" title="All 2 branches covered.">        if (provider == null) {</span>
<span class="fc" id="L28">            throw new IllegalArgumentException(&quot;Provider cannot be null&quot;);</span>
        }
<span class="fc" id="L30">        registry.put(provider.formatKey().toLowerCase(), provider);</span>
<span class="fc" id="L31">        return this;</span>
    }
    
    /**
     * Registers multiple document providers.
     * @param providers the providers to register
     * @return this factory for fluent chaining
     */
    public DocumentFactory registerAll(DocumentProvider... providers) {
<span class="fc bfc" id="L40" title="All 2 branches covered.">        for (DocumentProvider provider : providers) {</span>
<span class="fc" id="L41">            register(provider);</span>
        }
<span class="fc" id="L43">        return this;</span>
    }
    
    /**
     * Creates a document of the specified format.
     * @param formatKey the format key (case-insensitive)
     * @param title the document title
     * @return a new Document instance
     * @throws UnknownDocumentFormatException if the format is not registered
     */
    public Document createDocument(String formatKey, String title) {
<span class="fc" id="L54">        String key = formatKey.toLowerCase();</span>
<span class="fc" id="L55">        DocumentProvider provider = registry.get(key);</span>
        
<span class="fc bfc" id="L57" title="All 2 branches covered.">        if (provider == null) {</span>
<span class="fc" id="L58">            throw new UnknownDocumentFormatException(formatKey);</span>
        }
        
<span class="fc" id="L61">        return provider.create(title);</span>
    }
    
    /**
     * Checks if a format is supported.
     * @param formatKey the format key to check
     * @return true if the format is registered
     */
    public boolean supportsFormat(String formatKey) {
<span class="fc" id="L70">        return registry.containsKey(formatKey.toLowerCase());</span>
    }
    
    /**
     * Gets all registered format keys.
     * @return unmodifiable set of format keys
     */
    public Set&lt;String&gt; getSupportedFormats() {
<span class="fc" id="L78">        return Collections.unmodifiableSet(registry.keySet());</span>
    }
    
    /**
     * Creates a factory with default document providers (PDF, Word, HTML).
     * @return a pre-configured DocumentFactory
     */
    public static DocumentFactory createDefault() {
<span class="fc" id="L86">        return new DocumentFactory()</span>
<span class="fc" id="L87">                .register(new PdfDocumentProvider())</span>
<span class="fc" id="L88">                .register(new WordDocumentProvider())</span>
<span class="fc" id="L89">                .register(new HtmlDocumentProvider());</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>