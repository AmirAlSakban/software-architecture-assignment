<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>WordDocument.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">assignment1</a> &gt; <a href="index.source.html" class="el_package">editor.formats</a> &gt; <span class="el_source">WordDocument.java</span></div><h1>WordDocument.java</h1><pre class="source lang-java linenums">package editor.formats;

import editor.core.AbstractDocument;

import java.nio.charset.StandardCharsets;

/**
 * Word document implementation.
 * Simulates Word-specific save and render behavior.
 */
public class WordDocument extends AbstractDocument {
    
    public static final String FORMAT_KEY = &quot;word&quot;;
    
    public WordDocument(String title) {
<span class="fc" id="L16">        super(title);</span>
<span class="fc" id="L17">    }</span>
    
    @Override
    public byte[] save() {
        // Simulate Word XML format (simplified DOCX structure)
<span class="fc" id="L22">        String wordContent = &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&quot; +</span>
                &quot;&lt;w:document xmlns:w=\&quot;http://schemas.openxmlformats.org/wordprocessingml/2006/main\&quot;&gt;\n&quot; +
                &quot;  &lt;w:body&gt;\n&quot; +
<span class="fc" id="L25">                &quot;    &lt;w:title&gt;&quot; + escapeXml(title) + &quot;&lt;/w:title&gt;\n&quot; +</span>
                &quot;    &lt;w:p&gt;\n&quot; +
                &quot;      &lt;w:r&gt;\n&quot; +
<span class="fc" id="L28">                &quot;        &lt;w:t&gt;&quot; + escapeXml(content) + &quot;&lt;/w:t&gt;\n&quot; +</span>
                &quot;      &lt;/w:r&gt;\n&quot; +
                &quot;    &lt;/w:p&gt;\n&quot; +
                &quot;  &lt;/w:body&gt;\n&quot; +
                &quot;&lt;/w:document&gt;&quot;;
<span class="fc" id="L33">        return wordContent.getBytes(StandardCharsets.UTF_8);</span>
    }
    
    @Override
    public String render() {
<span class="fc" id="L38">        return &quot;[Word Document Preview]\n&quot; +</span>
               &quot;┌─────────────────────────────────┐\n&quot; +
               &quot;│ &quot; + title + &quot;\n&quot; +
               &quot;├─────────────────────────────────┤\n&quot; +
<span class="fc" id="L42">               &quot;│ &quot; + content.replace(&quot;\n&quot;, &quot;\n│ &quot;) + &quot;\n&quot; +</span>
               &quot;└─────────────────────────────────┘\n&quot; +
               &quot;[End of Word Preview]&quot;;
    }
    
    @Override
    public String getFormatKey() {
<span class="fc" id="L49">        return FORMAT_KEY;</span>
    }
    
    private String escapeXml(String text) {
<span class="pc bpc" id="L53" title="1 of 2 branches missed.">        if (text == null) return &quot;&quot;;</span>
<span class="fc" id="L54">        return text.replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;)</span>
<span class="fc" id="L55">                   .replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;)</span>
<span class="fc" id="L56">                   .replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;)</span>
<span class="fc" id="L57">                   .replace(&quot;\&quot;&quot;, &quot;&amp;quot;&quot;)</span>
<span class="fc" id="L58">                   .replace(&quot;'&quot;, &quot;&amp;apos;&quot;);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>